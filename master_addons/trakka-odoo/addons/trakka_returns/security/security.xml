<?xml version="1.0" encoding="UTF-8"?>
<odoo>
    <!-- Groups already exist in trakka_ops:
         trakka_ops.trakka_group_finance, trakka_ops.trakka_group_admin, trakka_ops.trakka_group_ops -->

    <!-- Company-scoped record rules -->
    <record id="trkka_returns_rule_case_company" model="ir.rule">
        <field name="name">Return Case: company domain</field>
        <field name="model_id" ref="model_trakka_return_case"/>
        <field name="domain_force">[('company_id','child_of',[user.company_id.id])]</field>
        <field name="groups" eval="[(4, ref('trakka_ops.trakka_group_ops')), (4, ref('trakka_ops.trakka_group_finance')), (4, ref('trakka_ops.trakka_group_admin'))]"/>
    </record>

    <record id="trkka_returns_rule_policy_company" model="ir.rule">
        <field name="name">Policy: company domain</field>
        <field name="model_id" ref="model_trakka_policy"/>
        <field name="domain_force">[('company_id','child_of',[user.company_id.id])]</field>
        <field name="groups" eval="[(4, ref('trakka_ops.trakka_group_ops')), (4, ref('trakka_ops.trakka_group_finance')), (4, ref('trakka_ops.trakka_group_admin'))]"/>
    </record>

    <!-- Permissions nuance (high level):
         - Ops: create/view return cases; can approve
         - Finance/Admin: can reverse & credit (stock/accounting) -->
</odoo>
