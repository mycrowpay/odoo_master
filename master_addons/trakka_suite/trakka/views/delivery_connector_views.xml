<?xml version="1.0" encoding="utf-8"?>
<odoo>

  <!-- Tree -->
  <record id="view_trakka_delivery_connector_tree" model="ir.ui.view">
    <field name="name">trakka.delivery.connector.tree</field>
    <field name="model">trakka.delivery.connector</field>
    <field name="arch" type="xml">
      <tree string="Delivery Connectors">
        <field name="name"/>
        <field name="implementation_model"/>
        <field name="active"/>
      </tree>
    </field>
  </record>

  <!-- Full Form (menu) -->
  <record id="view_trakka_delivery_connector_form" model="ir.ui.view">
    <field name="name">trakka.delivery.connector.form</field>
    <field name="model">trakka.delivery.connector</field>
    <field name="arch" type="xml">
      <!-- Also hide followers/activities just in case -->
      <form string="Delivery Connector"
            class="o_form_no_followers o_form_no_activity"
            context="{
              'res_model': 'trakka.delivery.connector',
              'default_res_model': 'trakka.delivery.connector',
              'default_model': 'trakka.delivery.connector'
            }">
        <header>
          <field name="active"/>
        </header>

        <sheet>
          <group>
            <field name="name" placeholder="e.g. GIG Logistics API"/>
            <field name="implementation_model_id"
                required="1"
                options="{'no_create': True, 'no_create_edit': True}"
                domain="[('model', 'ilike', 'trakka.connector.%')]"
                context="{'search_default_model': 'trakka.connector.'}"/>

            <field name="implementation_model" readonly="1"/>
          </group>

          <group string="Credentials / Config">
            <field name="api_key"/>
            <field name="api_secret" password="1"/>
            <field name="webhook_secret" password="1"/>
            <field name="extra_config" placeholder="Optional JSON/YAML for provider-specific options"/>
          </group>
        </sheet>

        <!-- No <chatter/> here -->
      </form>
    </field>
  </record>

  <!-- Minimal Quick-Create Form (NO Activities/Followers) -->
  <record id="view_trakka_delivery_connector_quick_form" model="ir.ui.view">
    <field name="name">trakka.delivery.connector.form.quick</field>
    <field name="model">trakka.delivery.connector</field>
    <field name="priority" eval="90"/>
    <field name="arch" type="xml">
      <form string="Create Delivery Connector"
            create="true" edit="true"
            class="o_form_no_followers o_form_no_activity"
            context="{
              'res_model': 'trakka.delivery.connector',
              'default_res_model': 'trakka.delivery.connector',
              'default_model': 'trakka.delivery.connector'
            }">
        <sheet>
          <group>
            <field name="name" required="1"/>
            <field name="implementation_model_id"
                required="1"
                options="{'no_create': True, 'no_create_edit': True}"
                domain="[('model', 'ilike', 'trakka.connector.%')]"
                context="{'search_default_model': 'trakka.connector.'}"/>

          </group>
          <group string="Credentials / Config (optional)">
            <field name="api_key"/>
            <field name="api_secret" password="1"/>
            <field name="webhook_secret" password="1"/>
          </group>
        </sheet>
        <!-- No <chatter/> here -->
      </form>
    </field>
  </record>

  <!-- Action (with explicit context) -->
  <record id="action_trakka_delivery_connector" model="ir.actions.act_window">
    <field name="name">Delivery Connectors</field>
    <field name="res_model">trakka.delivery.connector</field>
    <field name="view_mode">tree,form</field>
    <field name="context">
      {
        'res_model': 'trakka.delivery.connector',
        'default_model': 'trakka.delivery.connector',
        'default_res_model': 'trakka.delivery.connector'
      }
    </field>
  </record>

  <!-- Menu -->
  <menuitem id="menu_trakka_delivery_connector"
            parent="menu_trakka_root"
            action="action_trakka_delivery_connector"
            sequence="80"/>

</odoo>
